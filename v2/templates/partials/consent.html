<div id="consentBanner" style="position:fixed;left:1rem;right:1rem;bottom:1rem;background:#111;color:#fff;padding:1rem;border-radius:.75rem;display:none;z-index:1000">
  <span>Allow analytics to help us improve? <a href="/privacypolicy/" style="color:#9ae6b4">Learn more</a></span>
  <div style="float:right;gap:.5rem;display:inline-flex">
    <button id="consentAccept" style="background:#22c55e;color:#000;border:0;padding:.5rem .75rem;border-radius:.5rem">Accept</button>
    <button id="consentDecline" style="background:#e2e8f0;color:#111;border:0;padding:.5rem .75rem;border-radius:.5rem">Decline</button>
  </div>
</div>
<script>(function(){
  var KEY='consent_choice_v2';
  var banner=document.getElementById('consentBanner');
  if(!localStorage.getItem(KEY)){ banner.style.display='block'; }

  function loadGA(id){
    if(window.gaLoaded) return; window.gaLoaded=true;
    var s=document.createElement('script'); s.async=true; s.src='https://www.googletagmanager.com/gtag/js?id='+id; document.head.appendChild(s);
    window.dataLayer=window.dataLayer||[]; window.gtag=function(){dataLayer.push(arguments);};
    gtag('js', new Date()); gtag('config', id, {anonymize_ip:true}); gtag('consent','update',{analytics_storage:'granted'});
  }

  var a=document.getElementById('consentAccept');
  var d=document.getElementById('consentDecline');
  if(a){ a.addEventListener('click', function(){ localStorage.setItem(KEY,'accepted'); loadGA('%GA4_ID%'); banner.remove(); }); }
  if(d){ d.addEventListener('click', function(){ localStorage.setItem(KEY,'declined'); banner.remove(); }); }
})();</script>
